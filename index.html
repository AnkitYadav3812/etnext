<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ETNext ‚Äî Smart News & Weather</title>

<link rel="icon" href="etnext-logo.png" type="image/png" />

<!-- SHARE PREVIEW -->
<meta property="og:title" content="ETNext ‚Äî Smart News & Weather" />
<meta property="og:description" content="AI-powered breaking news, trending updates & live headlines." />
<meta property="og:image" content="https://ankityadav3812.github.io/etnext/etnext-logo.png" />
<meta property="og:url" content="https://ankityadav3812.github.io/etnext/" />
<meta property="og:type" content="website" />

<style>
:root {
  --primary:#d32f2f;
  --foreground:#111;
  --accent:#f6f6f8;
}
.dark {
  --primary:#ef5350;
  --foreground:#fff;
  --accent:#1e1e1e;
}
body {
  margin:0;
  font-family:"Poppins",sans-serif;
  background:var(--accent);
  color:var(--foreground);
  transition:0.3s ease;
}

/* HEADER */
header {
  background:var(--primary);
  padding:1rem 2rem;
  display:flex;
  justify-content:space-between;
  align-items:center;
  color:#fff;
  position:sticky;
  top:0;
  z-index:20;
}
header img {
  height:45px;
  border-radius:6px;
}

/* NAVIGATION */
nav {
  display:flex;
  flex-wrap:wrap;
  gap:0.6rem;
}
nav button {
  background:rgba(255,255,255,0.1);
  color:white;
  border:none;
  padding:0.45rem 1rem;
  border-radius:20px;
  cursor:pointer;
}
nav button.active,
nav button:hover {
  background:white;
  color:var(--primary);
}

/* SEARCH */
.search-container {
  max-width:600px;
  margin:1rem auto;
  display:flex;
  gap:0.5rem;
}
.search-bar {
  flex:1;
  padding:0.75rem 1rem;
  border-radius:25px;
  border:1px solid #ccc;
  font-size:1rem;
}
.voice-btn {
  width:45px;
  height:45px;
  border-radius:50%;
  background:var(--primary);
  color:white;
  border:none;
  cursor:pointer;
  font-size:1.3rem;
}

/* TRENDING BAR */
#trending-bar {
  background:white;
  padding:10px;
  font-weight:bold;
  color:#d32f2f;
  overflow:hidden;
  white-space:nowrap;
  border-bottom:1px solid #ddd;
}

/* GRID */
main {
  max-width:1200px;
  margin:auto;
  padding:1rem;
}
.news-grid {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(300px,1fr));
  gap:1rem;
}
.news-card {
  background:white;
  padding:1rem;
  border-radius:10px;
  box-shadow:0 2px 5px rgba(0,0,0,0.1);
  cursor:pointer;
  transition:0.2s;
}
.news-card:hover { transform:translateY(-2px); }

.news-card h3 {
  margin:0;
  font-size:1.1rem;
}

footer {
  background:#111;
  color:#ccc;
  text-align:center;
  padding:2rem;
  margin-top:2rem;
}

.theme-toggle {
  position:fixed;
  right:1rem;
  bottom:1rem;
  background:var(--primary);
  border:none;
  width:50px;
  height:50px;
  border-radius:50%;
  font-size:1.4rem;
  color:#fff;
}
</style>
</head>
<body>

<header>
  <img src="etnext-logo.png" alt="logo">
  <nav id="nav"></nav>
</header>

<div id="trending-bar">üî• Trending: Loading...</div>

<div class="search-container">
  <input id="search-input" class="search-bar" placeholder="Search news...">
  <button id="voice-btn" class="voice-btn">üé§</button>
</div>

<main>
  <div id="content">‚è≥ Loading...</div>
</main>

<footer>¬© 2025 ETNext ‚Äî Smart News Platform</footer>

<button class="theme-toggle" id="theme-toggle">üåô</button>
<script>
// =============== CATEGORY LIST ===============
const categories = [
  { name: "World", q: "world news" },
  { name: "India", q: "india news" },
  { name: "Business", q: "business news" },
  { name: "Tech", q: "technology news" },
  { name: "Sports", q: "sports news" },
  { name: "Entertainment", q: "entertainment news" }
];

const nav = document.getElementById("nav");
const content = document.getElementById("content");
const trendingBar = document.getElementById("trending-bar");
let currentQuery = "world news";

// =============== BUILD NAV BUTTONS ===============
categories.forEach(cat => {
  const btn = document.createElement("button");
  btn.textContent = cat.name;
  btn.onclick = () => loadNews(cat.q);
  nav.appendChild(btn);
});

// =============== FIXED WORKING RSS LOADER ===============
async function fetchRSS(query) {
  const url =
    "https://news.google.com/rss/search?q=" +
    encodeURIComponent(query) +
    "&hl=en-IN&gl=IN&ceid=IN:en";

  const proxy = "https://thingproxy.freeboard.io/fetch/";
  const res = await fetch(proxy + url);
  const text = await res.text();

  const xml = new DOMParser().parseFromString(text, "text/xml");
  return Array.from(xml.querySelectorAll("item"));
}

// =============== LOAD NEWS ===============
async function loadNews(q) {
  currentQuery = q;
  content.innerHTML = "‚è≥ Loading...";

  try {
    const items = await fetchRSS(q);

    const grid = document.createElement("div");
    grid.className = "news-grid";

    items.slice(0, 12).forEach(item => {
      const title = item.querySelector("title")?.textContent || "";
      const link = item.querySelector("link")?.textContent;
      const descRaw = item.querySelector("description")?.textContent || "";
      const desc = descRaw.replace(/<[^>]*>?/gm, "").slice(0, 150);

      const card = document.createElement("div");
      card.className = "news-card";
      card.innerHTML = `
        <h3>${title}</h3>
        <p>${desc}</p>
        <a href="${link}" target="_blank" style="color:#d32f2f;">Read More ‚Üí</a>
      `;

      grid.appendChild(card);
    });

    content.innerHTML = "";
    content.appendChild(grid);
  } catch (e) {
    content.innerHTML = "‚ö†Ô∏è Error loading news.";
  }
}

// =============== TRENDING HEADLINES ===============
async function updateTrending() {
  try {
    const items = await fetchRSS("top news india");
    const headlines = items.slice(0, 10).map(i =>
      i.querySelector("title")?.textContent
    );

    trendingBar.textContent = "üî• Trending: " + headlines.join(" ‚Ä¢ ");
  } catch {
    trendingBar.textContent = "üî• Trending: Unable to load.";
  }
}

// Update trending every 3 minutes
setInterval(updateTrending, 180000);

// =============== AUTO REFRESH NEWS ===============
setInterval(() => {
  loadNews(currentQuery);
}, 300000); // 5 minutes

// =============== SEARCH ===============
document.getElementById("search-input").addEventListener("keypress", e => {
  if (e.key === "Enter") {
    const q = e.target.value.trim();
    if (q) loadNews(q);
  }
});

// =============== VOICE SEARCH ===============
if ("webkitSpeechRecognition" in window || "SpeechRecognition" in window) {
  const Rec = window.SpeechRecognition || window.webkitSpeechRecognition;
  const rec = new Rec();
  rec.lang = "en-IN";

  document.getElementById("voice-btn").onclick = () => rec.start();

  rec.onresult = e => {
    const q = e.results[0][0].transcript;
    document.getElementById("search-input").value = q;
    loadNews(q);
  };
}

// =============== DARK MODE ===============
document.getElementById("theme-toggle").onclick = () => {
  document.body.classList.toggle("dark");
  document.getElementById("theme-toggle").textContent =
    document.body.classList.contains("dark") ? "‚òÄÔ∏è" : "üåô";
};

// =============== INITIAL LOAD ===============
updateTrending();
loadNews(currentQuery);
</script>
</body>
</html>
